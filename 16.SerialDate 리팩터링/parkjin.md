# SerialDate 리팩터링

Jcommon 라이브러리 내의 SerialDate 클래스를 탐험

## 첫째, 돌려보자

- 모든 경우에 대해 점검하지 않음
    - 테스트 커버리지 분석 도구(Clover)에 따르면, 대략 50% 정도만 테스트하는 것을 확인 할 수 있음
    - 클래스를 이해하며 리팩토링을 진행하기 위해서 훨씬 높은 테스트 커버리지가 필요하여 독자적인 단위 테스트 케이스를 구현함 (P.484, 목록 B-4)


아래 같이 변경한 SerialDate는 모든 테스트 테스트 케이스를 통과함

- P.484, 23~63행
    - 설계상으로는 통과하지 않아야 맞지만, 저자의 판단으로는 통과해야 한다고 생각

- P.454, 259행, 263행
    - ```stringToWeekdayCode```라는 메서드를 왜 만들었는지 모르겠지만, 일단 만들었다면, 대소문자 구분 없이 모두 통과해야 한다고 봤음
    - ```equalsIgnoreCase```로 바꾸면 충분했음

- P.484, 32행, 45행
    - tues, thurs라는 약어를 지원해야 할지 분명치 않음

- P.487, 163~213행
    - ```stringToMonthCode``` 메서드 수정

- P.491, 318행
    - ```getFollowingDayOfWeek``` 메서드의 버그 수정

- P.464, 719행
    - 항상 거짓인 알고리즘을 수정

- P.493, 417행 & P.494, 429행
    - ```weekInMonthToString```과 ```relativeToString```에서 오류 문자열을 반환하는 대신 IllegalArgumentException을 던져 테스트를 통과시킴

## 둘째, 고쳐보자

- P.448, 1행
    - 변경 이력이 예전에는 필요했으나, 소스 코드 제어 도구를 사용하는 현재는 변경 이력은 없애도 됨

- P.449, 61행
    - import문은 ```java.text.```*와 ```java.util.*```으로 줄여도 됨

    - 개인적인 생각
        - 다른 패키지에 동일한 이름의 클래스 존재할 가능성
         - IDE를 사용하여 코드를 replce 할 때, 놓칠 가능성

- P.449, 68행
    - javadoc 주석은 HTML 태크를 사용함. 그러나 한 소스코드에 여러 언어를 사용하기 때문에 ```<pre>```로 감싸는 것이 좋음

- P.450, 86행
    - Serial Number(일련번호)를 사용해서 구현했기 때문에 SerialDate지만, 저자는 서술적인 이름이 아니라 생각함
    - SerialDate라는 이름은 구현을 암시하는데, 실상은 추상 클래스임. 구현을 암시할 이유가 전혀없기에 구현은 숨기는 편이 좋음

## 결론
- 보이스카우트 규칙을 따랐음. 체크아웃 < 체크인
- 테스트 커버리지가 증가했으며, 버그를 고쳤으며, 코드가 줄었고 명확해짐
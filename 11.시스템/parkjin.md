# 시스템

## 도시를 세운다면?
도시를 혼자서 직접 관리하는 것은 불가능함. 그럼에도 도시가 잘 돌아가는 이유는
- 큰 그림을 그리는 사람뿐만 아니라 작은 사항에 집중하는 사람들
- 개인이 관리하는 구성요소를 효율적으로 돌아가게하는 적절한 추상화와 모듈화

## 시스템 제작과 사용을 분리하라
- **제작**과 **사용**은 매우 다름
- **시작 단계**라는 관심사를 모든 애플리케이션이 풀어야 함

```java

public Service getService() {
  if (service == null)
    service = new MyServiceImpl(...);
    
  return service;
}

```
- 초기화 지연 혹은 계산 지연이라는 기법을 이용해 런타임에서 실제로 필요하기 전까지 객체를 생성하지 않으므로 불필요한 부하가 걸리지 않음  
- 런타임 로직에서 해당 객체를 전혀 사용하지 않더라도 해당 객체에 대한 의존성이 생김
- 테스트에서도 테스트 전용 객체를 할당해야 하는 문제가 있음

## Main 분리
<img width="500" src="https://user-images.githubusercontent.com/50200481/205482490-cc8e0b74-487d-4b78-a3c0-9949c902243b.png">

> 출처: Clean Code 도서

- 시스템 생성과 시스템 사용을 분리하는 한 가지 방법
- 생성과 관련한 코드는 모두 main이나 main이 호출하는 모듈로 옮김
- 나머지 시스템은 모든 객체가 생성되었고 모든 의존성이 연결되었다고 가정함

## 팩토리
<img width="500" src="https://user-images.githubusercontent.com/50200481/205482779-b56908e9-f4f1-4b35-96d5-75a749be6df6.png">

> 출처: Clean Code 도서

- 객체가 생성되는 시점을 애플리케이션에서 결정할 필요도 생김
- LineItem 인스턴스를 생성하여 Order에 추가하는데 Abstract Factory 패턴을 사용함
- 생성 시점은 애플리케이션이 결정하지만 생성하는 코드는 애플리케이션이 모름

## 의존성 주입


